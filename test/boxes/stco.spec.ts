import { stco } from '../../src/fmp4/boxes/stco';
import * as dump from 'buffer-hexdump';

describe('stco box parse', () => {
  it('parse box', () => {
    const stcoDump = dump(stco({
      version: 0,
      samples: [
        589, 58472, 158725, 240056, 300356, 377438, 454568, 511184, 619699, 709668, 796190, 885200, 962067, 1043616, 1128195, 1185916, 1262273, 1352946, 1437759, 1506789, 1598077, 1697250, 1769216, 1839393, 1904278, 1966287, 2061777, 2122510, 2193806, 2249452, 2339236, 2397363, 2453790, 2523481, 2608804, 2696074, 2771285, 2829760, 2915124, 3012028, 3099455, 3194760, 3277325, 3330631, 3373198, 3450092, 3544863, 3598454, 3702143, 3801092, 3848548, 3975634, 4041443, 4121084, 4217222, 4297303, 4383658, 4479692, 4535652
      ]
    }));
    const expected = dump(Buffer.from(`
      00 00 00 FC 73 74 63 6F 00 00 00 00 00 00 00 3B
      00 00 02 4D 00 00 E4 68 00 02 6C 05 00 03 A9 B8
      00 04 95 44 00 05 C2 5E 00 06 EF A8 00 07 CC D0
      00 09 74 B3 00 0A D4 24 00 0C 26 1E 00 0D 81 D0
      00 0E AE 13 00 0F EC A0 00 11 37 03 00 12 18 7C
      00 13 42 C1 00 14 A4 F2 00 15 F0 3F 00 16 FD E5
      00 18 62 7D 00 19 E5 E2 00 1A FF 00 00 1C 11 21
      00 1D 0E 96 00 1E 00 CF 00 1F 75 D1 00 20 63 0E
      00 21 79 8E 00 22 52 EC 00 23 B1 A4 00 24 94 B3
      00 25 71 1E 00 26 81 59 00 27 CE A4 00 29 23 8A
      00 2A 49 55 00 2B 2D C0 00 2C 7B 34 00 2D F5 BC
      00 2F 4B 3F 00 30 BF 88 00 32 02 0D 00 32 D2 47
      00 33 78 8E 00 34 A4 EC 00 36 17 1F 00 36 E8 76
      00 38 7D 7F 00 3A 00 04 00 3A B9 64 00 3C A9 D2
      00 3D AA E3 00 3E E1 FC 00 40 59 86 00 41 92 57
      00 42 E3 AA 00 44 5A CC 00 45 35 64                
    `.replace(/\s/g, ''), 'hex'));

    expect(stcoDump).toEqual(expected);
  });
});
